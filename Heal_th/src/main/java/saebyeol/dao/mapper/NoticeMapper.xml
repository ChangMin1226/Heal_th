<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DTD -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="saebyeol.dao.face.NoticeDao">
 
 	<!-- 페이징 처리 -->
 	<select id="selectCntAll" resultType="int">
 		SELECT count(*) FROM notice
 	</select>
 	
 	<!-- 게시글 목록 -->
 	<select id="selectList" resultType="Notice" parameterType="SaebyeolPaging">
 		SELECT * FROM (
 			SELECT rownum rnum, N.* FROM(
 				SELECT
 					notice_no, notice_ttl, notice_date, 
 					notice_hit, notice_content, notice_file
				FROM notice
				ORDER BY notice_no DESC
 			) N
 		) NOTICE
 		WHERE rnum BETWEEN #{startNo } AND #{endNo }
 	</select>
 	
 	<!-- 조회수 증가 -->
 	<select id="updateHit" parameterType="Notice">
 		UPDATE notice SET notice_hit = notice_hit + 1 
 		WHERE notice_no = #{noticeNo}
 	</select>
 	
 	<!-- 게시글 선택 -->
 	<select id="selectNotice" resultType="Notice" parameterType="Notice">
 	SELECT
 		notice_no, notice_ttl, notice_date, notice_hit, notice_content, notice_file
 	FROM notice
 	WHERE notice_no = #{noticeNo}
 	</select>
 
 	<!-- 게시글 작성 -->
 	<insert id="insertNotice" parameterType="Notice">
 	<selectKey order="BEFORE" resultType="int" keyProperty="noticeNo">
 		SELECT notice_seq.nextval FROM dual
 	</selectKey>
 	INSERT INTO notice ( notice_no, notice_ttl, notice_date, notice_hit, notice_content ) 
 	VALUES ( #{noticeNo}, #{noticeTtl}, sysdate, '0', #{noticeContent}  )
 	</insert>
 	
 	<!-- 게시글 수정 -->
 	<update id="updateNotice" parameterType="Notice">
 	UPDATE notice
 	SET notice_ttl = #{noticeTtl} , notice_content = #{noticeContent}
 	WHERE notice_no = #{noticeNo}
 	</update>
 	
 	<!-- 게시글 삭제 -->
 	<delete id="delete" parameterType="Notice">
 	DELETE notice
 	WHERE notice_no = #{noticeNo}
 	</delete>
 	

</mapper>